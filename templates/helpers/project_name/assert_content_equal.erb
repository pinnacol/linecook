Asserts the content of the file is as expected. Prints a diff and exits 1 if
the content is not as expected.
(expected, file)
--
expected='<%= '<' %>%= expected.rstrip %<%= '>' %>'
actual=$(cat <%= '<' %>%= file %<%= '>' %>)

echo "Check file: <%= '<' %>%= file %<%= '>' %>"
if [ "$actual" != "$expected" ]
then
  echo "[$0] unequal output: <%= '<' %>%= file %<%= '>' %>" >&2
  diff <(cat <<< "$expected") <(cat <<< "$actual") >&2
  exit 1
fi

